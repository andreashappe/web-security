
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../session_management/">
      
      
        <link rel="next" href="../sso/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Autorisierung - Web Application Security</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#authorization" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href="../.." title="Web Application Security" class="md-header__button md-logo" aria-label="Web Application Security" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Web Application Security
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Autorisierung
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Web Application Security" class="md-nav__button md-logo" aria-label="Web Application Security" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Web Application Security
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../todo.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Contribute
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Einführung
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Einführung
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/security_principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grundprinzipien
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/security_as_process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sicherheit als Prozess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration mit dem Umfeld
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/crypto_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kryptographische Grundlagen
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Web Grundlagen
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Web Grundlagen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web-applications/web_technologies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technologien
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web-applications/web_applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Applikationen
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Zugriffskontrolle
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Zugriffskontrolle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identifikation und Authentifizierung
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session-Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Autorisierung
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Autorisierung
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#probleme-bei-der-berechtigungsuberprufung" class="md-nav__link">
    <span class="md-ellipsis">
      Probleme bei der Berechtigungsüberprüfung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Probleme bei der Berechtigungsüberprüfung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keinefehlende-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Keine/Fehlende Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unterschiedliche-authorization-in-alternate-channels" class="md-nav__link">
    <span class="md-ellipsis">
      Unterschiedliche Authorization in Alternate Channels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unterschiedliche Authorization in Alternate Channels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#probleme-bei-verwendung-von-websockets" class="md-nav__link">
    <span class="md-ellipsis">
      Probleme bei Verwendung von WebSockets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hint-update-operationen" class="md-nav__link">
    <span class="md-ellipsis">
      Hint: Update Operationen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mass-assignments" class="md-nav__link">
    <span class="md-ellipsis">
      Mass-Assignments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scoping-von-daten" class="md-nav__link">
    <span class="md-ellipsis">
      Scoping von Daten
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-of-check-time-of-use-toctou" class="md-nav__link">
    <span class="md-ellipsis">
      Time of Check, Time of Use (TOCTOU)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflektionsfragen" class="md-nav__link">
    <span class="md-ellipsis">
      Reflektionsfragen
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sso/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single-Sign On (SSO)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Server-Seitige Angriffe
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Server-Seitige Angriffe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../server-side-attacks/injection_attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angriffe
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Client-Seitige Angriffe
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Client-Seitige Angriffe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client-side-attacks/client_side_attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angriffe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client-side-attacks/client_side_hardening/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Härtungsmaßnahmen
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/mod_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache mod_security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entstehungsgeschichte
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/weitere-informationen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What to do next?
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#probleme-bei-der-berechtigungsuberprufung" class="md-nav__link">
    <span class="md-ellipsis">
      Probleme bei der Berechtigungsüberprüfung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Probleme bei der Berechtigungsüberprüfung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keinefehlende-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Keine/Fehlende Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unterschiedliche-authorization-in-alternate-channels" class="md-nav__link">
    <span class="md-ellipsis">
      Unterschiedliche Authorization in Alternate Channels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unterschiedliche Authorization in Alternate Channels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#probleme-bei-verwendung-von-websockets" class="md-nav__link">
    <span class="md-ellipsis">
      Probleme bei Verwendung von WebSockets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hint-update-operationen" class="md-nav__link">
    <span class="md-ellipsis">
      Hint: Update Operationen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mass-assignments" class="md-nav__link">
    <span class="md-ellipsis">
      Mass-Assignments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scoping-von-daten" class="md-nav__link">
    <span class="md-ellipsis">
      Scoping von Daten
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-of-check-time-of-use-toctou" class="md-nav__link">
    <span class="md-ellipsis">
      Time of Check, Time of Use (TOCTOU)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflektionsfragen" class="md-nav__link">
    <span class="md-ellipsis">
      Reflektionsfragen
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="authorization">Authorization</h1>
<p>Unter Authorization versteht man die Kontrolle der Benutzerrechte vor
der Ausführung der jeweiligen Operation.</p>
<p>Bei einer fehlerhaften Authorization muss ein Angreifer sich zumindest
authentifizieren. Im Fehlerfall kann der Betreiben den Login- und
Registrierungsprozess unterbinden, alle Benutzer ausloggen und erhält
auf diese Weise eine Plattform, auf die ein trusted User wieder zulassen
kann um dadurch einen eingeschränkten Betrieb zu ermöglichen (während
der grundlegende Fehler behoben wird). Im Gegensatz dazu, muss bei einer
fehlenden Authentication die Plattform deaktiviert werden, da diese
Möglichkeit zur Einschränkung auf vertrauenswürdige Benutzer entfällt.</p>
<h2 id="probleme-bei-der-berechtigungsuberprufung">Probleme bei der Berechtigungsüberprüfung</h2>
<p>In diesem Kapitel wird auf mehrere Probleme im Zusammenhang mit
Bereichtungsüberprüfungen eingegangen.</p>
<h3 id="keinefehlende-authorization">Keine/Fehlende Authorization</h3>
<p>Die Applikation überprüft zwar die Authentication aber jeder eingeloggte
Benutzer darf alle Operationen aufrufen.</p>
<p>Da ein Benutzer sich initial authentifizieren muss, kann aufgrund des
Logverlaufs der Fehler zumindest analysiert und der bösartige User
ausgesperrt werden. Eine Gefährdung durch Crawler findet ebenso nicht
statt, da diese keine valide Authentication durchführen können.</p>
<p>Analog zu den Fehlern bei der Authentication, kann es zu Problemen
kommen wenn eine Applikation innerhalb mehrere
Programmiersprachen/Frameworks implementiert wurde bzw. weitere
Komponenten zu einer bestehenden Lösung hinzugefügt wurden. Hauptproblem
ist die Integration der Authorization in das Bestandssystem. Als
Pen-Tester sollte man immer diese Komponenten gezielt auf
Authentication- und Authorization-Fehler hin testen.</p>
<p><em>There is a special place in hell for developers that think that
not-displaying UI elements is a kind of authorization</em>. Häufig werden in
Abhängigkeit der Benutzerrolle nur Teile der Funktionalität angezeigt.
Ein Angreifer der einen zweiten Benutzeraccount mit diesen Rechten (oder
Log-Dateien) besitzt, erhält allerdings Informationen über die
Operationen und kann diese direkt aufrufen. Dies ist ein Fall von
Security by Obscurity.</p>
<p>Das erzwungene Aufrufen von Webseiten über URLs wird auch <em>Forceful
Browsing</em> genannt. Wird direkt auf Ressourcen, wie z. b. Downloadlinks,
zugegriffen, wird dies <em>direct object reference</em> genannt.</p>
<h3 id="unterschiedliche-authorization-in-alternate-channels">Unterschiedliche Authorization in Alternate Channels</h3>
<p>Falls eine Webapplikation Daten oder Operationen auf unterschiedliche
Arten und Weisen anbietet, müssen die Schutzmechanismen auf den
verschiedenen Kanälen synchronisiert werden.</p>
<p>Wird z.B. eine Operation direkt mittels der Webseite als auch über eine
SOAP Webservice-Schnittstelle (z.B. für eine mobile Applikation)
angeboten, müssen auf beiden Schnittstellen die gleichen
Zugriffsberechtigungen überprüft werden. Häufig kann man während
Penetration-Tests verminderte Schutzmaßnahmen bei
Webservice-Schnittstellen feststellen.</p>
<h4 id="probleme-bei-verwendung-von-websockets">Probleme bei Verwendung von WebSockets</h4>
<p>WebSockets unterliegen nicht der Same-Origin-Policy moderner Webbrowser.
Es wird daher empfohlen, bei öffnen des WebSockets serverseitig den
<em>Origin</em>-Header auf valide aufrufende Webseiten hin zu überprüfen.
Während des initialen Handshakes wird ein <em>Web-Socket-Key</em> übertragen.
Dieser dient nur zur Identifikation des Browsers gegenüber dem Webserver
und darf nicht zu Authentications- bzw. Authorization-Zwecken verwendet
werden.</p>
<p>Über WebSockets werden zumeist Nachrichten verschickt. Der Server wird
auf den Erhalt einer Nachricht hin eine Operation starten, vor dieser
muss der Server eine Berechtigungsüberprüfung durchführen. Die
Berechtigungen zwischen WebSockets und HTTP-basierte Kommunikation
müssen auf jeden Fall synchron gehalten werden (siehe auch, Different
Authorization in Alternate Channels). Ein häufiges Problem ist, dass der
Client vor der Authentication des WebBrowsers gegenüber dem Client
bereits einen WebSocket öffnet. In diesem Fall wird meistens eine
parallele Session-Verwaltung auf server-seite aufgebaut: innerhalb einer
Serverdatenbank wird für den WebSocket-Client eine Session-Id oder eine
Token-Id generiert, in der Datenbank der betreffende Web-Benutzer dem
Token zugeordnet und dem Client das token/die session mitgeteilt. Der
Webbrowser muss nun bei jeder WebSocket Anfrage dieses Secret mit
übertragen und der Server kann den User über dieses Token
identifizieren.</p>
<h3 id="hint-update-operationen">Hint: Update Operationen</h3>
<p>Anhand eines Beispiels soll gezeigt werden, warum auch einfache
Operationen komplexe Sicherheitsfragen aufwerfen können. Bei dem
konkreten Beispiel sollen Benutzerdaten aktualisiert werden. Hierfür
wird folgende Update-Operation aufgerufen:</p>
<pre><code>POST /user/update/1 HTTP/1.1
</code></pre>
<p>Als Parameter wird ein JSON-String mit den neuen Werten übergeben:</p>
<pre><code>{
    "id" : "1",
    "name" : "happe"
}
</code></pre>
<p>Bei diesem Beispiel fallen folgende sicherheitsrelevanten Fragen an:</p>
<ul>
<li>
<p>kann ich durch Setzen einer anderen ID (statt 1) in der URL auf
    einen anderen Datensatz schreibend zugreifen?</p>
</li>
<li>
<p>was passiert, wenn man die ID im Datensatz ändert? Teilweise
    überprüfen Webapplikationen nur die ID innerhalb der URL und
    ignorieren die IDs innerhalb des Datensatzes. Mit Glück kann man
    diesen Missmatch zum Überschreiben anderer Datensätze verwenden.</p>
</li>
<li>
<p>was passiert, wenn im Datensatz keine ID vorkommt und der Angreifer
    manuell ein ID-Element in das JSON-Dokument hinzufügt?</p>
</li>
<li>
<p>was passiert, wenn der Angreifer ein neues JSON-Element namens
    <em>“Admin”: “true”</em> hinzufügt?</p>
</li>
<li>
<p>was passiert, wenn der Angreifer statt HTTP POST eine HTTP GET
    Operation verwendet? HTTP GET sollte eigentlich eine read-only
    Operation sein, deswegen werden GET requests teilweise von
    Web-Application Firewalls nicht kontrolliert und man kann auf diese
    Weise Firewall-Regeln umgehen.</p>
</li>
</ul>
<h3 id="mass-assignments">Mass-Assignments</h3>
<p>Moderne Web-Frameworks versuchen die Effizienz von Programmierern zu
verbessern. Ein Feature, welches potentiell negativen Einfluss auf die
Sicherheit einer Applikation besitzt ist <em>mass assignments</em>.</p>
<p>Unter Mass-Assignment versteht man das automatisierte Zuweisen von
Werten aus einem HTTP Request zu einem Datenbank-Objekt. So könnten z.B.
bei einem User-Update die übergebenen HTTP-Parameter automatisch
gegenüber den bekannten Datenbankfeldern gematched werden und Parameter
wie z.B. <em>vorname</em> oder <em>nachname</em> werden automatisch auf das
Datenbankfeld <em>vorname</em> und <em>nachname</em> des betroffenen Datensatzes
gemapped und aktualisiert.</p>
<p>In Ruby on Rails würde der betroffene Code folgendermaßen aussehen:</p>
<pre><code>    @user = User.find(params[:id])
    @user.update(params[:user])
</code></pre>
<p>Die erste Zeile des Beispiels verwendet den übergebenen <em>id</em> Parameter
um aus der Datenbank ein User-Objekt zu laden. In der zweiten Zeile
werden nun die vorhandenen HTTP-Parameter automatisch den vorhandenen
Feldern des User-Objektes zugewiesen.</p>
<p>Dies ist aus Sicherheitssicht problematisch. Ein Angreifer kann
versuchen potentielle Datenbankfelder zu erraten und diese mittels
mass-assignment zuzuweisen. Beispiele wären z. b. das Setzen von
<em>role=admin</em> oder <em>admin=true</em>.</p>
<p>Um dies zu verhindern besitzen die meisten Frameworks ein Möglichkeit
Attribute für das Mass-Assignmentexplizit zu verbieten (black-list) oder
zu erlauben (white-list). Aus Sicherheitssicht ist das automatische
Ablehnen von Attributen und die explizite Freigabe einzelner Attribute
(also das White-Listing) vorzuziehen.</p>
<p>In Ruby on Rails würde der betroffene Code folgendermaßen aussehen:</p>
<pre><code>    @user = User.find(params[:id])
    @user.update(params.require(:user).permit(:full_name))
</code></pre>
<p>In diesem Fall werden nur die Felder <em>full_name</em> für das Objektes
<em>user</em> mittels mass-assignment aktualisiert.</p>
<h2 id="scoping-von-daten">Scoping von Daten</h2>
<p>Unter Scoping von Daten versteht man das Einschränken der verfügbaren
Daten auf einen Subbereich. Eine Web-Operation wird meistens für einen
Benutzer aufgerufen, die potentiell verfügbaren Daten sollten so früh
wie möglich auf die für den Benutzer verfügbaren Daten eingeschränkt
werden.</p>
<p>Beispiel: eine Applikation verwaltet Rechnungen, jede Rechnung hat einen
Benutzer als Autor. Mittels einer Update-Operation kann eine Rechnung
bearbeitet werden. Dies geschieht mittels der Operation
<a href="/invoice/1/update" class="uri">/invoice/1/update</a>, in der
Applikation ist der gerade angemeldete autorisierte User als
<em>current_user</em> bekannt, mittels <em>current_user.invoices</em> kann man auf
die Rechnungen des aktuellen Users zugreifen, mittels <em>Invoice</em> auf alle
Rechnungen die dem System bekannt sind.</p>
<p>Die Update-Operation sollte nun folgendermaßen aussehen:</p>
<pre><code>    # hier sollte NICHT Invoice.find(params[:id]) stehen
    @invoice = current_user.invoices.find(params[:id])

    # normaler Update-Code
    @invoice.update(the_data_which_will_be_updated)
    @invoice.save
</code></pre>
<p>Durch die Verwendung des User-Scopes wird implizit der Zugriff auf
Rechnungen des aktuellen Benutzers erzwungen. Dadurch müssen
Zugriffsberechtigungen nicht zusätzlich explizit kontrolliert werden.</p>
<h2 id="time-of-check-time-of-use-toctou">Time of Check, Time of Use (TOCTOU)</h2>
<p>Der Zeitpunkt der Berechtigungsüberprüfung ist essentiell. So genannte
<em>Time of Check, Time of Use</em> Angriffe nutzen racing conditions zwischen
der Überprüfung von Operationsberechtigungen und der Ausführung von
Operationen aus.</p>
<p>Ein gutes Beispiel für die TOCTOU-Problematik sind zumeist
Token-basierte Systeme. Hier wird die Berechtigung eines Anwenders
überprüft und danach ein Token mit einer definierten Laufzeit
ausgestellt. Wird das Token während der Laufzeit an eine Operation
überreicht, wird dieses valide Token als Zugangsberechtigung akzeptiert
und die Operation ausgeführt auch wenn zwischenzeitlich die
Berechtigungen des Benutzer modifiziert wurden und der Benutzer die
Operation eigentlich nicht mehr ausführen dürfe.</p>
<h2 id="reflektionsfragen">Reflektionsfragen</h2>
<ol>
<li>
<p>Erkläre den Unterschied zwischen Identifikation, Authentication und
    Authorization?</p>
</li>
<li>
<p>Was versteht man unter Authorization? Wann und wo sollte diese
    durchgeführt werden? Welches Sicherheitsproblem versteht man unter
    Insecure Direct Object Reference bzw. unter Forced Browsing?</p>
</li>
<li>
<p>Welche Probleme können im Zusammenhang mit Mass-Assignment
    auftreten?</p>
</li>
<li>
<p>Gegeben ein Webshop mit einem Downloadlink für Rechnungen
    <a href="http://shop.local/invoices/1/download">http://shop.local/invoices/1/download</a>. Welche
    sicherheitsrelevanten Fehler können hier nun auftreten?</p>
</li>
<li>
<p>Gegeben eine Profil-Updatefunktion welche als POST
    <a href="/user/1/update" class="uri">/user/1/update</a>
    implementiert wurde, als Parameter werden die Felder <em>id</em>, <em>email</em>,
    <em>new_password</em> und <em>rolle</em> (mit Wert <em>user</em>) übergeben. Erkläre
    zumindest drei Sicherheitsprobleme die während des Updates eines
    Benutzers auftreten können.</p>
</li>
</ol>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Zurück zum Seitenanfang
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.tracking", "navigation.path", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>